<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>OC-SNAP Doc</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <link href="extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href=".">OC-SNAP Doc</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="active">
                                <a href=".">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="user-guide/get-started/">Get Start</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="disabled">
                                <a rel="next" >
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="user-guide/get-started/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#snap-framework-hardware-and-software">SNAP Framework Hardware and Software</a></li>
        <li class="main "><a href="#1-overview">1. Overview</a></li>
            <li><a href="#header2">header2</a></li>
            <li><a href="#what-is-capi-education-materials-and-more-information">What is CAPI, education materials and more information</a></li>
            <li><a href="#status">Status</a></li>
        <li class="main "><a href="#2-getting-started">2. Getting started</a></li>
        <li class="main "><a href="#3-dependencies">3. Dependencies</a></li>
            <li><a href="#fpga-card-selection">FPGA Card selection</a></li>
            <li><a href="#development-step1-step2">Development (Step1 &amp; Step2)</a></li>
            <li><a href="#deployment-step3">Deployment (Step3)</a></li>
        <li class="main "><a href="#4-contributing">4. Contributing</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="snap-framework-hardware-and-software">SNAP Framework Hardware and Software</h1>
<h1 id="1-overview">1. Overview</h1>
<h2 id="header2">header2</h2>
<h3 id="header-3">header 3</h3>
<h4 id="header4">header4</h4>
<p>The SNAP Framework enables programmers and computer engineers to quickly create FPGA-based acceleration actions that work on server host data, as well as data from storage, flash, Ethernet, or other connected resources.  SNAP, therefore, is an acronym for “<strong>S</strong>torage, <strong>N</strong>etwork, and <strong>A</strong>nalytics <strong>P</strong>rogramming”.
The SNAP framework makes it easy to create accelerated actions utilizing the IBM <strong>C</strong>oherent <strong>A</strong>ccelerator <strong>P</strong>rocessor <strong>I</strong>nterface (CAPI).</p>
<table>
<thead>
<tr>
<th>This is a table</th>
<th>Really a table</th>
<th>rere</th>
</tr>
</thead>
<tbody>
<tr>
<td>let's say</td>
<td>A nice</td>
<td>fyle</td>
</tr>
<tr>
<td>good</td>
<td>bad</td>
<td>note</td>
</tr>
<tr>
<td>nice</td>
<td>good</td>
<td>each</td>
</tr>
</tbody>
</table>
<pre><code class="C">for (i= 0; i &lt; 100; i++)
    j--;
</code></pre>

<div class="admonition danger">
<p class="admonition-title">A danger is approaching</p>
</div>
<p>​    This is very dangerous.This is a note. That is a note. This is a note. That is a note. This is a note. <code>That is a note</code>. This is a note. That is a note. This is a note. That is a note. This is a note. That is a note. This is a note. That is a note. This is a note. That is a note. This is a note. That is a note. </p>
<pre><code>This

is

very
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>​    This is very dangerous.
​  <br />
​    This is is very danger.</p>
<div class="admonition usage">
<p class="admonition-title">Usage</p>
</div>
<p>​    This is very dangerous.
​  <br />
​    This is isvery danger.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>​    This is very dangerous.</p>
<pre><code>This is isvery danger.
</code></pre>
<pre><code>theme:
    name: null
    custom_dir: 'custom_theme/'
</code></pre>

<p><img alt="snap_concept_diagram" src="index.assets/snap_concept_diagram.png" /></p>
<p>The framework hardware consists of a AXI-to-CAPI bridge unit, memory-mapped register I/O, host DMA, and a job management unit.
It interfaces with a user-written action (a.k.a. kernel) through an AXI-lite control interface, and gives coherent access to host memory through AXI. Optionally, it also provides access to the on-card DRAM via AXI.
A NVMe host controller-AXI bridge complements the framework for storage or database applications as an independent unit.
Software gets access to the action through the libsnap library, allowing applications to call a "function" instead of programming an accelerator.
The framework supports multi-process applications and can be extended to support multiple instantiated hardware actions in parallel.<br />
<strong>Note:</strong> The current 1.x releases support a single action per FPGA.</p>
<p>This project is an initiative of the OpenPOWER Foundation Accelerator Workgroup.
Please see here for more details:
<em> https://members.openpowerfoundation.org/wg/ACLWG/dashboard
</em> http://openpowerfoundation.org/blogs/capi-drives-business-performance/</p>
<h2 id="what-is-capi-education-materials-and-more-information">What is CAPI, education materials and more information</h2>
<ul>
<li>CAPI and SNAP on IBM developerworks: https://developer.ibm.com/linuxonpower/capi/  </li>
<li><a href="https://developer.ibm.com/answers/smartspace/capi-snap/index.html">IBM Developerworks Forum, tag CAPI_SNAP</a></li>
<li><a href="https://developer.ibm.com/linuxonpower/capi/education/">Education Videos</a></li>
</ul>
<h2 id="status">Status</h2>
<p>Currently the SNAP Framework supports CAPI1.0 on POWER8 based hosts and CAPI2.0 on POWER9 based hosts. A similar OpenCAPI SNAP framework is going to be added in a new repository. Users working on SNAP today can easily transfer their CAPI1.0 work to CAPI2.0 or OpenCAPI as the interface for "<strong>Software Program</strong>" and "<strong>Hardware Action</strong>" (shown in the yellow areas of the above figure) will stay the same. </p>
<h1 id="2-getting-started">2. Getting started</h1>
<p>Developing an FPGA accelerated application on SNAP can be done following the steps listed below, but this sequence is not mandatory.</p>
<ul>
<li>
<p><strong>Preparation</strong>: Decide the software function to be moved to FPGA. This function, usually computation intensive, is named as "action" in the following description. </p>
</li>
<li>
<p><strong>Step1</strong>. Put the action code into a function in the main software code, and determine the function parameters required. Add the few libsnap API functions that required to set up CAPI to the main software. The best way is to start from an example (See in <a href="./actions">actions</a>) and read the code within the "sw" directory. </p>
</li>
<li>
<p><strong>Step2</strong>. Write the "hardware action" in a supported programming language, such as Vivado HLS or Verilog/VHDL. For <strong>HLS</strong>, developers can write their algorithms in C/C++ syntax within an function wrapper "hls_action()". Developers who prefer <strong>HDL(Verilog/VHDL)</strong>, can use their adapted version of "action_wrapper.vhd" as top-level. It includes several AXI master interfaces and one AXI-lite slave interface. Refer to the "hw" directory in "hls_*" or "hdl_*" for action examples.<br />
  For <strong>simulation</strong> of the hardware action, the PSLSE (<strong>P</strong>ower <strong>S</strong>ervice <strong>L</strong>ayer <strong>S</strong>imulation <strong>E</strong>ngine) provides a software emulation of the whole path from <strong>libcxl</strong> library to the <strong>P</strong>ower <strong>S</strong>ervice <strong>L</strong>ayer (see the blue boxes in the picture above). This allows for simulating the action without access to an FPGA card or a POWER system. When the simulation is successful, you are ready to <strong>generate the FPGA bitstream</strong>. 
  <strong>Note</strong> : there is no need to build a specific testbench to test your application in FPGA. This is a key advantage as your code is the testbench.
  Please read the <a href="hardware/README.md">hardware/README.md</a> for more details. </p>
</li>
<li>
<p><strong>Step3</strong>. Program the bitstream to a real FPGA card plugged into a <strong>POWER or OpenPOWER</strong> machine and run your calling software from it. This step is also called <strong>Deployment</strong>.
  Please see <a href="hardware/doc/Bitstream_flashing.md">Bitstream_flashing.md</a> for instructions on how to program the FPGA bitstream.</p>
</li>
</ul>
<p>For a step-by-step help, please refer to the SNAP Workbooks in the <a href="./doc">doc</a> directory. For example, make sure you read the <a href="./doc/UG_CAPI_SNAP-QuickStart_on_a_General_Environment.pdf">QuickStart Guide</a> if you're a first time user. Some other user application notes are also there.</p>
<p>Please also have a look at <a href="./actions">actions</a> to see several examples which may help you get started with coding. Each example has a detailed description in its own "doc" directory.</p>
<h1 id="3-dependencies">3. Dependencies</h1>
<h2 id="fpga-card-selection">FPGA Card selection</h2>
<p>As of now, the following FPGA cards can be used with SNAP <em>(see <a href="./doc/README.md#p8-capi10-snap-fpga-supported-boards">cards ressources details</a>)</em> :
<em> for POWER8 (CAPI1.0):
  * Alpha-Data ADM-PCIE-KU3        http://www.alpha-data.com/dcp/products.php?product=adm-pcie-ku3
  * Alpha-Data ADM-PCIE-8K5 (rev2) http://www.alpha-data.com/dcp/products.php?product=adm-pcie-8k5
  * Nallatech 250S-2T with two on-card NVMe M.2 960GB drives http://www.nallatech.com/250s
  * Semptian NSA121B http://www.semptian.com/proinfo/10.html
</em> for POWER9 (CAPI2.0):
  * Nallatech 250SP  http://www.nallatech.com/250sp
  * Flyslice FX609 http://www.flyslice.com/page434?product_id=27
  * Semptian NSA241 http://www.semptian.com/proinfo/126.html
  * ReflexCES XpressVUP LP9P https://www.reflexces.com/products-solutions/other-cots-boards/xilinx/xpressvup</p>
<h2 id="development-step1-step2">Development (Step1 &amp; Step2)</h2>
<p>Development is usually done on a Linux (x86) computer. 
See examples of <a href="./doc#p8-development-environments-">supported development configurations</a>.
The required tools and packages are listed below. Web access to github is recommended to follow the build instructions. A real FPGA card is not required for the plain hardware development.</p>
<h3 id="a-xilinx-vivado">(a) Xilinx Vivado</h3>
<p>SNAP currently supports Xilinx FPGA devices, exclusively. For synthesis, simulation model and image build, the Xilinx Vivado 2018.1 tool suite is recommended.</p>
<p>https://www.xilinx.com/products/design-tools/hardware-zone.html</p>
<h3 id="b-capi-board-support-and-psl">(b) CAPI board support and PSL</h3>
<p>Access to CAPI from the FPGA card requires the <strong>P</strong>ower <strong>S</strong>ervice <strong>L</strong>ayer (<strong>PSL</strong>) as well as a <strong>B</strong>oard <strong>S</strong>upport <strong>P</strong>ackage (<strong>BSP</strong>) for CAPI2.0 cards.
Detailed information is available in <a href="hardware/README.md">hardware/README.md</a></p>
<h3 id="c-build-process">(c) Build process</h3>
<p>Building the code and running the make environment requires the usual development tools <code>gcc, make, sed, awk</code>. If not installed already, the installer package <code>build-essential</code> will set up the most important tools.</p>
<p>Configuring the SNAP framework via <code>make snap_config</code> will call a standalone tool that is based on the Linux kernel kconfig tool. This tool gets automatically cloned from</p>
<p>https://github.com/guillon/kconfig</p>
<p>The <code>ncurses</code> library must be installed to use the menu-driven user interface for kconfig.</p>
<p>Please see <a href="hardware/README.md#image-and-model-build">Image and model build</a> for more information on the build process.</p>
<h3 id="d-run-simulation">(d) Run Simulation</h3>
<p>For simulation, SNAP relies on the <code>xterm</code> program and on the PSL Simulation Environment (PSLSE) which is available on github</p>
<p>https://github.com/ibm-capi/pslse</p>
<p>Please see <a href="hardware/sim/README.md#pslse-setup">PSLSE Setup</a> for more information.</p>
<p>Simulating the NVMe host controller including flash storage devices requires licenses for the Cadence Incisive Simulator (IES) and DENALI Verification IP (PCIe and NVMe). However, building images is possible without these licenses.
For more information, see the <a href="hardware/sim/README.md">Simulation README</a>.</p>
<h2 id="deployment-step3">Deployment (Step3)</h2>
<p>Deployment is on a Power or OpenPower server with an FPGA card plugged.
See examples of <a href="./doc#p8-deployment-environment-ibm-server-examples-supporting-capi-snap-">supported deployment configurations</a>.</p>
<p>This code uses libcxl to access the CAPI hardware. Install it with the package manager of your Linux distribution, e.g. 
<code>sudo apt-get install libcxl-dev</code> for Ubuntu.<br />
For more information, please see https://github.com/ibm-capi/libcxl</p>
<p>SNAP uses the generic tools to update CAPI card FPGA bitstreams from https://github.com/ibm-capi/capi-utils</p>
<h1 id="4-contributing">4. Contributing</h1>
<p>This is an open-source project. We greatly appreciate your contributions and collaboration. 
Before contributing to this project, please read and agree to the rules in
* <a href="CONTRIBUTING.md">CONTRIBUTING.md</a></p>
<p>To simplify the sign-off, you may want to create a ".gitconfig" file in you home by executing:</p>
<pre><code>$ git config --global user.name &quot;John Doe&quot;
$ git config --global user.email johndoe@example.com
</code></pre>

<p>Then, for every commit, use <code>git commit -s</code> to add the "Signed-off by ..." message.</p>
<p>By default the git repository is read-only. Users can fork the snap repository, make the changes there and issue a pull request.
Even members with write access to this repository can't commit directly into the protected master branch. To contribute changes, please create a branch, make the changes there and issue a pull request.</p>
<p>Pull requests to merge into the master branch must be reviewed before they will be merged.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2018-12-18 00:58:00
-->
